<!DOCTYPE html>
<html>
<head>
	<title>Teacher Availability</title>

	<!--Import Google Icon Font-->
    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!--Import jQuery before materialize.js-->
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>

	<!-- Compiled and minified CSS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">

	<!-- Compiled and minified JavaScript -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>

	<!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

	<!-- Moment.js -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.13.0/moment.min.js"></script>
	
</head>
<body>

<div class="container">

	<div class="row">
		<div class="col s12">
			<h1>Teacher Availability</h1>
		</div>
		<div class="row">
		    <div class="input-field col s6">
				<input value="Alvin" id="teacherName" type="text" class="validate">
				<label class="active" for="teacherName">First Name</label>
		    </div>
		</div>
	</div>

	<label for="theDate">Select a Date:</label>
	<input id="theDate" type="date" class="datepicker">

	<div class="row">
		<div class="input-field col s6">
			<select id='startTime'>
				<option value="" disabled selected>Choose your option</option>
				<option value="06:00:00">6:00am</option>
				<option value="06:30:00">6:30am</option>
				<option value="07:00:00">7:00am</option>
				<option value="07:30:00">7:30am</option>
				<option value="08:00:00">8:00am</option>
				<option value="08:30:00">8:30am</option>
				<option value="09:00:00">9:00am</option>
				<option value="09:30:00">9:30am</option>
				<option value="10:00:00">10:00am</option>
				<option value="10:30:00">10:30am</option>
				<option value="11:00:00">11:00am</option>
				<option value="11:30:00">11:30am</option>
				<option value="12:00:00">12:00pm</option>
				<option value="12:30:00">12:30pm</option>
				<option value="13:00:00">1:00pm</option>
				<option value="13:30:00">1:30pm</option>
				<option value="14:00:00">2:00pm</option>
				<option value="14:30:00">2:30pm</option>
				<option value="15:00:00">3:00pm</option>
				<option value="15:30:00">3:30pm</option>
				<option value="16:00:00">4:00pm</option>
				<option value="16:30:00">4:30pm</option>
				<option value="17:00:00">5:00pm</option>
				<option value="17:30:00">5:30pm</option>
				<option value="18:00:00">6:00pm</option>
				<option value="18:30:00">6:30pm</option>
				<option value="19:00:00">7:00pm</option>
				<option value="19:30:00">7:30pm</option>
				<option value="20:00:00">8:00pm</option>
				<option value="20:30:00">8:30pm</option>
				<option value="21:00:00">9:00pm</option>
				<option value="21:30:00">9:30pm</option>
			</select>
			<label>Materialize Select</label>
		</div>
		<div class="input-field col s6">
			<select id='endTime'>
				<option value="" disabled selected>Choose your option</option>
				<option value="06:00:00">6:00am</option>
				<option value="06:30:00">6:30am</option>
				<option value="07:00:00">7:00am</option>
				<option value="07:30:00">7:30am</option>
				<option value="08:00:00">8:00am</option>
				<option value="08:30:00">8:30am</option>
				<option value="09:00:00">9:00am</option>
				<option value="09:30:00">9:30am</option>
				<option value="10:00:00">10:00am</option>
				<option value="10:30:00">10:30am</option>
				<option value="11:00:00">11:00am</option>
				<option value="11:30:00">11:30am</option>
				<option value="12:00:00">12:00pm</option>
				<option value="12:30:00">12:30pm</option>
				<option value="13:00:00">1:00pm</option>
				<option value="13:30:00">1:30pm</option>
				<option value="14:00:00">2:00pm</option>
				<option value="14:30:00">2:30pm</option>
				<option value="15:00:00">3:00pm</option>
				<option value="15:30:00">3:30pm</option>
				<option value="16:00:00">4:00pm</option>
				<option value="16:30:00">4:30pm</option>
				<option value="17:00:00">5:00pm</option>
				<option value="17:30:00">5:30pm</option>
				<option value="18:00:00">6:00pm</option>
				<option value="18:30:00">6:30pm</option>
				<option value="19:00:00">7:00pm</option>
				<option value="19:30:00">7:30pm</option>
				<option value="20:00:00">8:00pm</option>
				<option value="20:30:00">8:30pm</option>
				<option value="21:00:00">9:00pm</option>
				<option value="21:30:00">9:30pm</option>
			</select>
			<label>Materialize Select</label>
		</div>
		<a class="waves-effect waves-light btn" id="button">button</a>
	</div>

</div>

<script type="text/javascript">

	$(document).ready(function() {

		console.log(moment('2010-10-20 12:10:30').isAfter('2010-01-01 12:10:30'));

	    $('select').material_select();

	    $('.datepicker').pickadate({
	    	min: new Date(), // Can't select a date before today
			selectMonths: true, // Creates a dropdown to control month
			selectYears: 15 // Creates a dropdown of 15 years to control year
		});

	    $('#button').click(function(){
	    	// alert( $('#startTime option:selected').val() )
	    	// alert( $('#theDate').val() )
	    	// alert( moment( $('#theDate').val() + " " + $('#startTime option:selected').val() ).format('YYYY-MM-DD HH:mm:SS') );
	    	var timeToPush = moment( $('#theDate').val() + " " + $('#startTime option:selected').val() ).format('YYYY-MM-DD HH:mm:SS');

	    	var formattedEndTime = moment( $('#theDate').val() + " " + $('#endTime option:selected').val() ).format('YYYY-MM-DD HH:mm:SS');
	    	// alert(formattedEndTime)

	    	// Won't let you submit unless the end time is greater than the start time. 
	    	if ( moment(formattedEndTime).diff(moment(timeToPush), 'minutes') <= 0 ) {
	    		alert('Please make sure your end time is greater than your starting time!');
	    		return;
	    	}

	    	// var numberOfSessions = moment(formattedEndTime).diff(moment(timeToPush), 'minutes') / 30;

	    	alert(moment(formattedEndTime).diff(moment(timeToPush), 'minutes'))
	    	// alert(numberOfSessions)

	  //   	for (var m = moment(timeToPush); m.isBefore(moment(formattedEndTime)); m.add(30, 'minutes')) {
			// 	console.log(m.format('YYYY-MM-DD HH:mm:SS'))
			// }

	    	var originURL = document.location.origin;

		    var newSession = {
				name: $('#teacherName').val(),
				time: timeToPush,
				endTime: formattedEndTime
			};

		    $.post(originURL + '/api/teacher', newSession).done(function(data){

		    	console.log(newSession);
				console.log(data);

			});

	    });

	    // alert( moment() );
	    // alert( moment().format("YYYY-MM-DD") );
	    // alert( moment("20111031", "YYYYMMDD").format("YYYY-MM-DD") );

	});



</script>

</body>
</html>